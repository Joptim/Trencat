.. _speed-profile-optimization:

Speed profile optimization
--------------------------

A key aspect in train automation is to define algorithms to generate optimal reference trajectories. The aim of such trajectories is to determine what should be the position, velocity, traction and braking force of the train at each time period. The *speed profile optimization* problem consists in solving an optimal control problem based on the train operation model described in :ref:`automatic-train-control`\ . The objective function is usually a trade-off between train efficiency and riding comfort. In addition, the problem must be feasible, meaning that the train must depart and arrive on time (if possible) and stick to the speed limits at each segment.

.. figure:: /_static/speed_profile_ATO.jpg
   :alt: Speed profile generated by the :term:`ATO`.
   
   Speed profile generated by the :term:`ATO` (obtained from [YTYXHG]_\ ).
   
Once the profile has been generated, the train must stick to this profile between the two stations. If the train cannot attain the profile due to any disturbances, then a new profile must be re-computed on the fly based on the current position and velocity of the train.

The speed profile generation problem has been solved from many points of view. Check [YTYXHG]_ for exhaustive references of state-of-the-art solutions for this problem:

   - Using linear optimization by linearizing non-linear models.
   - Using Tabu Search.
   - Using Simulated annealing algorithms.
   - Using Ant colony optimization
   - Using Genetic algorithms.
   - Using Multiple-phase optimal control and pseudospectral methods.
   - Using Lagrange multipliers algorithms and other numerical algorithms.
   - Using sequential quadratic programming.
   - Using dynamic programming.
   - Using predictive optimization control.
   - A large etc.

Currently *TrenCAT* implements a Mixed Integer Linear Programming approach for a single train greatly explained in [WNBS]_. Documentation would look really nice if such model was included here. However, it is a bit verbose, and there is no point in copy/pasting all computations. Instead, it is strongly recommend to enjoy the reading directly from the author.

Previous topic: :ref:`automatic-train-control`.

Next topic: :ref:`passenger-demand-modelling`.
